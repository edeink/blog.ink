$(function(){var t=$(window),i="is-active",e="fix",n=$("header h1"),a=n.is(":hidden")?0:n.height(),o=142,s=$("#switch").attr("data-switch"),r=s?JSON.parse(s):"",c={prefix:"edeity-theme_",throttle:function(t,i){i=Number(i)||0;var e,n,a=Date.now(),o=null;return function(s){var r=Date.now();e=this;var c=r-a;return void 0===n?(a=r,n=-1,o=t.apply(this,s)):c<i?(clearTimeout(n),n=setTimeout(function(){return t.apply(e,s),o},i-c),o):(a=r,t.apply(this,s),o)}},scrollTo:function(t,i){i||(i=0);var e=$("html, body");if(e.animate)return isFromClick=!0,e.animate({scrollTop:t.offset().top-i+"px"},{duration:300,easing:"swing",complete:function(){isFromClick=!1}}),!1},getItem:function(t){return window.localStorage.getItem(c.prefix+t)},setItem:function(t,i){window.localStorage.setItem(c.prefix+t,i)}},l=function(){$(".gif").each(function(){var i=$("<div class='gif-container'>"),e=$(this),n=e.attr("data-src"),a=$("<canvas>"),o=parseInt(e.attr("width")),s=parseInt(e.attr("height")),r=o,c=s,l=$('<span class="stop"><span class="iconfont icon-stop"></span></span>').hide(),d=$('<span class="play"><span class="iconfont icon-play"></span></span>').hide(),h=$('<div class="lds-ring"><div></div><div></div><div></div><div></div></div>');function f(){var t=e.attr("auto"),n=$(".list-item").width();(r>n||void 0!==t)&&(c=n/o*s,r=n),e.attr("width",r),e.attr("height",c),r&&c&&(i.css({width:r,height:c}),!0===e.data("init")&&(a.attr("width",r).attr("height",c),a[0].getContext("2d").drawImage(e[0],0,0,r,c)))}e.before(i),f(),i.append(e).append(d).append(l).append(h),e.hide(),e.attr("src",n),e.on("load",function(){if(h.hide(),d.show(),!0===e.data("init"));else{i.append(a),a.attr("width",r).attr("height",c),(new Image).src=e.attr("src"),a[0].getContext("2d").drawImage(e[0],0,0,r,c),e.hide();var t=!1;d.on("click",function(i){t||(a.hide(),e.show(),e.attr("src","").attr("src",n),d.addClass("fadeOut"),setTimeout(function(){d.hide(),l.show().removeClass("fadeOut")},500),t=!0)}),l.on("click",function(i){t&&(a.show(),e.hide(),l.addClass("fadeOut"),setTimeout(function(){l.hide(),d.show().removeClass("fadeOut")},500),t=!1)}),e.data("init",!0)}}),t.resize(f)})},d={allLength:0,activeIndex:0,isDuringScroll:!1,init:function(){var e,n,a,o=$(".img-list"),s=$('<div class="list-container">'),r=o.find("img"),c=$('<div class="img-container">'),l=$('<div class="preview-list-container">');d.allLength=r.length;var h=$('<div class="preview-container">');r.each(function(){var t=$('<div class="wrapper">'),i=$(this).attr("data-src"),e=i+"?x-oss-process=style/preview";if(t.attr("data-src",i),t.css({"background-image":"url("+e+")"}),$(this).attr("data-desc")){var n=$('<span class="desc">').text($(this).attr("data-desc"));t.append(n)}c.append(t);var a=$('<div class="preview-wrapper">'),o=$('<div class="preview">');o.css({"background-image":"url("+e+")"}),a.append(o),h.append(a)});var f=$('<div class="hover">'),u=$('<div class="progress">');r.each(function(){var t=$('<div class="each-progress">');u.append(t)}),o.empty(),s.append(c),s.append(u),l.append(h),o.append(s),o.append(l),o.append(f),e=$(".wrapper");var p=$(".each-progress");p.eq(0).addClass(i);var v=$(".preview-wrapper");v.eq(0).addClass(i),C(0),w(),t.resize(w);var g=-1,m=-1;function w(){n=parseInt(o.css("width")),c.css("width",n*r.length),e.css("width",n),a=parseInt(v.css("width")),h.css("width",a*v.length),d.isDuringScroll||(k(d.activeIndex,!1),I(d.activeIndex),x(d.activeIndex,!1))}function C(t){var i=e.eq(t);if(i.length>0&&"true"!==i.attr("data-load")){var n=i.attr("data-src");i.attr("data-load","true");var a=new Image;a.src=n,a.onload=function(){i.css({"background-image":"url("+n+")"})}}}function k(t,i){C(t);var e=t*n+"px";!1!==i?$(s).animate({scrollLeft:e},{duration:500,easing:"swing",complete:function(){d.isDuringScroll=!1}}):$(s).scrollLeft(t*n)}function I(t){p.removeClass(i),p.eq(t).addClass(i)}function x(t,e){var n=t*a;d.activeIndex>t?n+=2*a:n-=2*a,v.removeClass(i),v.eq(t).addClass(i),!1!==e?$(l).animate({scrollLeft:n+"px"},{duration:500,easing:"swing",complete:function(){d.isDuringScroll=!1}}):$(l).scrollLeft(n)}f.on("touchstart",function(t){g=t.originalEvent.touches[0].pageX,m=-1}),f.on("touchmove",function(t){m=t.originalEvent.touches[0].pageX}),f.on("touchend",function(){var t=g-m;t>0&&Math.abs(t)>50?function(){if(!d.isDuringScroll){d.isDuringScroll=!0,d.activeIndex++;var t=d.activeIndex=d.activeIndex>d.allLength-1?0:d.activeIndex;k(t),I(t),x(t)}}():t<0&&Math.abs(t)>50&&function(){if(!d.isDuringScroll){d.isDuringScroll=!0,d.activeIndex--;var t=d.activeIndex=d.activeIndex<0?d.allLength-1:d.activeIndex;k(t),I(t),x(t)}}()}),v.on("click",function(){if(!d.isDuringScroll){var t=d.activeIndex=v.index($(this));k(t),x(t)}})}},h=function(){var i=$("#nav-bar"),n=$(".head-link"),s=$(".link-container"),r=i.find("ol.toc"),l=c.throttle(function(){var r=t.scrollTop();r>=a?(n.addClass(e),i.addClass(e),s.addClass(e)):r<=o&&(n.removeClass(e),i.removeClass(e),s.removeClass(e))},32);!function(i,e,n,a){var o=a.offset,s=e||"is-active",r=[],l=-1,d=$(i||".nav-link"),h=!1;d.each(function(){var t=$(this).children(".toc-link").attr("href"),i=decodeURI(t.substr(1,t.length));r.push($("#"+i).offset().top-o)}),r.push($(document).height()),d.on("click",function(t){console.log($(this));var i=$(this).children(".toc-link").attr("href"),e=decodeURI(i.substr(1,i.length));c.scrollTo($("#"+e),o),$(this).hasClass(s)||(d.removeClass(s),$(this).addClass(s)),t.stopPropagation()});var f=c.throttle(function(){if(h)return!1;var t=$(document).scrollTop();t=void 0!==t?t:window.pageYOffset,r.some(function(i,e){if(t+1<i){var a=e-1;if(a!==l&&a>=0){var o=d.eq(a);o&&!o.hasClass(s)&&(d.removeClass(s),o.addClass(s)),l=a,$.isFunction(n)&&n(o,l)}return!0}return!1})},100);f();t.scroll(function(){f()})}(".toc-item",null,function(t){var i=t.position().top;const e=r.innerHeight();(i>e||i<0)&&$(r).animate({scrollTop:t[0].offsetTop-e/2+"px"},{duration:100,easing:"swing",complete:function(){}})},{offset:78}),l(),t.scroll(function(){l()})},f={isMenuHide:!1,$linkUl:$("ul.some-link"),$linkIcon:$("a#link-list i"),init:function(){f.initEvent()},initEvent:function(){var i=$("#light-or-not"),e=$("html");i.on("click",function(){e.addClass("transition-all-color"),e.hasClass("night")?(e.removeClass("night"),c.setItem("theme","light")):(e.addClass("night"),c.setItem("theme","night")),setTimeout(function(){e.removeClass("transition-all-color")},500)});var n=$("#up-to-top");n.on("click",function(){c.scrollTo($("body"))}),$(this).scrollTop()>400&&n.show(),t.on("scroll",function(){$(this).scrollTop()>400?n.show():n.hide()})}},u={init:function(){var n=$(".toolbar");n.find(".icon-menu").on("click",function(t){n.addClass(i),$(".head-link").addClass(i),$("body").addClass("no-scroll"),t.stopPropagation()}),n.on("click",function(){n.removeClass(i),$(".head-link").removeClass(i),$("body").removeClass("no-scroll")});var a=c.throttle(function(){t.scrollTop()>200?n.addClass(e):n.removeClass(e)},100);a(),u.acitveLink(),t.on("scroll",function(){a()})},acitveLink:function(){var t=$(".head-link .btn"),e=window.location.pathname;t.each(function(){$(this).attr("href")===e&&$(this).addClass(i)})}},p=function(){var t=$("body").find("#data-title");t.length>0?t.txt(eachTitle):(t=$("<div>").attr({id:"data-title",class:"pop-title"}),$("body").append(t)),$(".pop").hover(function(){var i=$(this).offset().top,e=$(this).outerWidth(),n=$(this).outerHeight(),a=$(this).offset().left,o=$(this).attr("data-title"),s=$(this).attr("data-direction");t.html(o);var r=t.outerWidth(),c=t.outerHeight();switch(t.removeClass("left").removeClass("right").removeClass("top").removeClass("bottom"),t.addClass(s),s){case"right":i+=n/2,a=a+e+r/2+10;break;case"left":i+=n/2,a=a-r/2-10;break;case"bottom":i=i+n+c/2+10,a+=e/2;break;case"top":i=i-c/2-10,a+=e/2}t.css({top:i,left:a}),t.fadeIn()},function(){t.hide()})},v={init:function(){v.inSafeFrame()},inSafeFrame:function(){if(window.top!==window&&document.referrer){var t=document.createElement("a");t.href=document.referrer;var i=t.hostname,e=function(t,i){return-1!==t.indexOf(i,t.length-i.length)};e(i,".ede.ink")||e(i,"localhost")||(top.location.href="https://ede.ink")}}},g=function(){$(".article img").dblclick(function(){var t=$(".img-modal"),i=$("body");(t=t.length>0?t:$("<div>").addClass("img-modal")).empty();var e=$(this)[0].getBoundingClientRect(),n=$('<img class="img-copy">').attr("src",$(this).attr("src"));function a(){var t=(window.innerWidth-160)/e.width,i=(window.innerHeight-160)/e.height,a=Math.min(t,i);n.css({top:110,left:(window.innerWidth-e.width*a)/2,width:e.width*a,height:e.height*a})}function o(){n.css({left:e.left,right:e.right,top:e.top,width:e.width,height:e.height}),t.fadeOut(function(){t.remove(),i.css("overflow","auto")}),$(window).off("resize",a),$(window).off("keydown",s),t.off("click",o)}function s(t){27!==t.keyCode&&13!==t.keyCode||o()}n.css({left:e.left,right:e.right,top:e.top,width:e.width,height:e.height}),t.append(n),i.append(t),i.css("overflow","hidden"),t.fadeIn(),setTimeout(function(){a()},100),$(window).on("resize",a),$(window).on("keydown",s),t.on("click",o)})};l(),d.init(),f.init(),p(),v.init(),u.init(),g(),!0===r.toc&&h(),!0===r.use_pwa&&h()});