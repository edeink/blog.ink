<!doctype html><html lang="zh-CN" class="night"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1,maximum-scale=4,user-scalable=0" name="viewport"><title>Ede&#39;s Blog</title><meta name="description" content="Try to be a qualified programmer"><meta property="og:type" content="website"><meta property="og:description" content="Try to be a qualified programmer"><meta property="og:title" content="Ede&#39;s Blog"><meta property="og:site_name" content="Ede&#39;s Blog"><meta property="og:url" content="https://ede.ink"><meta property="og:image" content="https://edeity.oss-cn-shenzhen.aliyuncs.com/public/edeity_o.png"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="mainfest" href="/mainfest.json"><link rel="stylesheet" href="/public/css/common.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_707055_4b9og9sc5lx.css"><script>!function(){var e=-1!==window.location.search.indexOf("theme=night")||"night"===window.localStorage.getItem("edeity-theme_theme"),t=-1!==window.location.search.indexOf("theme=light")||"light"===window.localStorage.getItem("edeity-theme_theme");(new Date).getHours();var n=document.querySelector("html");e?n.classList.add("night"):t?n.classList.remove("night"):n.classList.add("night")}(),document.addEventListener("DOMContentLoaded",function(){null!==document.querySelector("ol.toc")&&(document.querySelector("#nav-bar").style.cssText="display: block")})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-M3J9QSEE2Z"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-M3J9QSEE2Z")</script><meta name="generator" content="Hexo 5.0.0"></head><body><div class="loading"></div><div id="switch" data-switch="{&#34;toc&#34;:true,&#34;use_pwa&#34;:false}"></div><header class="fullscreen"><div class="toolbar"><i class="iconfont icon-menu"></i></div><h1><a href="/">Ede&#39;s Blog</a></h1><div class="head-link"><a class="btn waves" href="/"><span><i class="iconfont icon-home">Home </i></span></a><a class="btn waves" href="/about/index.html"><span><i class="iconfont icon-me">About </i></span></a><a class="btn waves" target="_blank" rel="noopener" href="https://github.com/edeink"><span><i class="iconfont icon-github">Github</i></span></a></div></header><div class="some-link"><a class="btn" id="light-or-not"><i class="iconfont icon-light"></i> </a><a style="display:none" class="btn" id="up-to-top"><i class="iconfont icon-up"></i></a></div><div id="nav-bar" style="display:none"><div class="toc"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E6%8D%A2%EF%BC%88transform%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">变换（transform）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%89%E6%A0%85%E5%8C%96%EF%BC%88Rasterization%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">光栅化（Rasterization）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9D%80%E8%89%B2%EF%BC%88shading%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">着色（shading）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%B4%E5%9B%BE%EF%BC%88Texture-Mapping%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">贴图（Texture Mapping）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TODO-%E5%87%A0%E4%BD%95%EF%BC%88Geometry%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">TODO 几何（Geometry）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%89%E7%BA%BF%E8%BF%BD%E8%B8%AA%EF%BC%88Ray-Tracing%EF%BC%89"><span class="toc-number">6.</span> <span class="toc-text">光线追踪（Ray Tracing）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TODO-%E6%9D%90%E8%B4%A8%E4%B8%8E%E5%A4%96%E8%A7%82%EF%BC%88Material%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">TODO 材质与外观（Material）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E5%AE%83"><span class="toc-number">8.</span> <span class="toc-text">其它</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">总结</span></a></li></ol></div></div><main id="content-main" class="section"><div class="list-item"><h1 class="post-title"><a id="摘要，图形学入门 WIP" class="article-link" href="">摘要，图形学入门 WIP</a></h1><div class="post-meta"><time class="meta published">Jan 31, 2022</time></div><div class="article"><div class="post-excerpt markdown-body"><p class="alert">学习的摘抄，无营养的碎碎念。 不小心Post到博客上了，本想删除，又念来字节后，虽日常思考比之前要多，但均记录在飞书文档上，而荒废了博客。 决定保留此文，稍以润色，当作博客还「存活」的标记吧。## 图形学</p><blockquote><p>以下为Games 101网课笔记。</p><p>由于大学没有选修此门功课，在此拜读。</p></blockquote><h3 id="变换（transform）"><a href="#变换（transform）" class="headerlink" title="变换（transform）"></a>变换（transform）</h3><p>作为一名前端er，对于<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/transform">变换</a>可谓非常熟悉，伸缩（Scale）、旋转（Rotate）、平移（translate）、变形（sheard）等，其均可通过向量 + 矩阵的乘法表述，又为变换矩阵（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Transformation_matrix">Transformation matric</a>）。为什么要变化为矩阵？答：<strong>统一且高效</strong>。</p><h3 id="光栅化（Rasterization）"><a href="#光栅化（Rasterization）" class="headerlink" title="光栅化（Rasterization）"></a>光栅化（Rasterization）</h3><p>将矢量图形数据投影到屏幕坐标（只是坐标的变换，不是显示到屏幕上啊喂）的过程，称为光栅化（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Rasterisation">Rasterization</a>）。众所周知，屏幕由像素点组合而成，像素点最小单位为1，是不连续 / 离散。但矢量图形是连续的，从连续（数据）到不连续（实际显示），需要经过「采样」（Sampling）。采样，必定存在信息的丢失，常见现象，就是「锯齿」（Aliasing），作为一名游戏万家，对抗锯齿（Anti-Aliasing）不可谓不熟悉。<small>（GTMD的狗日ETC，害得老子没得3060Ti Van ♂ 游戏，只能学图形学。）</small>课程讲述的抗锯齿的方法有三：</p><ol><li><strong>先「模糊」再「采样」</strong>，称为「多重采样抗锯齿」（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Multisample_anti-aliasing">Multisample anti-aliasing</a>）。很容易理解，模糊，就是将特征从一个点的特征到周围，做到你中有我，我中有你。PS抠图后也常用模糊处理边界，减少突兀。</li><li><strong>从上一帧查找灵感</strong>，如：「快速近似抗锯齿」（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Fast_approximate_anti-aliasing">Fast approximate anti-aliasing</a>）、时间抗锯齿（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Temporal_anti-aliasing">Temporal anti-aliasing</a>）。也比较容易理解，MSAA，是在同一时间，单一位置的模糊，而TAA，是不同时间，单一位置的模糊。</li><li><strong>根据经验，去猜</strong>。2022年，涉及猜的东西，想必第一反应便是：「机器学习」。如：N家的<a target="_blank" rel="noopener" href="https://www.nvidia.com/en-us/geforce/technologies/dlss/">DLSS</a>、A家的<a target="_blank" rel="noopener" href="https://www.amd.com/en/technologies/fidelityfx-super-resolution">FSR</a>、以及原来是小瘪三之I家的<a target="_blank" rel="noopener" href="https://www.intel.cn/content/www/cn/zh/products/docs/arc-discrete-graphics/xess.html">Xss</a>。均是如此。<small>（往自己脸上贴金之：最近勾搭上，我有一位同学之，港大博士毕业之 两年三篇次顶会一作之 腾讯技术大咖专项SSSP之 图形学新生代之 我的大学 <del>实验室</del> 自习室之 反正不管怎么吹工资差不多是我两倍之 林同学，从事2d → 3d建模还原，通过的也是机器学习 + 几何算法。）</small></li></ol><p>采样的另一个弊端则是：<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/zh-my/%E8%8E%AB%E5%88%97%E6%B3%A2%E7%B4%8B">摩尔纹</a>（moiré pattern）。网课于此，对于摩尔纹的产生原因「<strong>采样的速度跟不上信号的变化</strong>」觉得难以理解。目前的理解是：因为显示器光栅化的过程不是瞬时，而可能逐行或逐列，甚至某些优化算法，可能是跳行或跳列等。比如我买的投影仪，虽然光学镜头是720P，但通过快速抖动，变成伪1080P。当采样的频率和图像的频率不同（辅助理解的<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/21341910">链接</a>），如课程中举例，正交投影下的，倾斜的单元网格.jpg</p><p>在此简单带过了一个概念，<a target="_blank" rel="noopener" href="https://zh.m.wikipedia.org/zh/%E6%B7%B1%E5%BA%A6%E7%BC%93%E5%86%B2">深度缓冲</a>（Z-buffer）。用于解决<strong>三维坐标</strong>投影到二维平面时，二维坐标相同，不同三位点的可见性问题。当存在Alpha通道，可能会在着色上做加权运算。</p><h3 id="着色（shading）"><a href="#着色（shading）" class="headerlink" title="着色（shading）"></a>着色（shading）</h3><p>顾名思义，就是对一个点上颜色。看似非常简单，但稍以了解，可谓技巧满满。因为不同的着色可以代表不同的光照和材质！也就是说，同一个3D模型，应用不同的着色，既表现为冰，又可表现为火，冰火两重天啊有木有！对此我是表示怀疑的，但随后略读了开源书籍 <a target="_blank" rel="noopener" href="https://thebookofshaders.com/">The Book of Shader</a>（介绍了GLSL着色器语言）。竟然至今还有各种论文，我承认，它确实牛逼好吧。</p><p>对于光照，常见的是应用<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Blinn%E2%80%93Phong_reflection_model">布林-冯反射模型</a>，可分解为：高光 + 漫反射 + 平行 / 环境光的加权组合。了解不深，只能<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/364086530">上！才！艺！</a>。截止于此，目前的渲染管线（物理），即为：图形 -&gt; 三角化 -&gt; 光栅 -&gt; 着色。</p><h3 id="贴图（Texture-Mapping）"><a href="#贴图（Texture-Mapping）" class="headerlink" title="贴图（Texture Mapping）"></a>贴图（Texture Mapping）</h3><p>Long Long Age，自学Blender And Threejs，对贴图略知一二。简单来说，就是很多哇塞酷炸天的渲染效果，即时计算的话，需要耗费大量CPU或GPU算力，如果能提前渲染成图片（2D），再通过某种规则映射到物体（3D）上，就能提高帧率了，本质上空间换时间，就也很哇塞拉。「预烘焙」，在游戏中是常见的优化手段之一。弊端嘛，玩过游戏的也知道，因为贴图是2D的，没有空间属性，换个角度就GG了，常用于固定视角、或远景、或人物纹理等。最常见的贴图方式，便是uv贴图（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/UV_mapping">uv mapping</a>，辅助了解<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/95925245">链接</a>）。而其他的诸如不同的插值方式有：<a target="_blank" rel="noopener" href="https://zh.m.wikipedia.org/zh-hans/%E5%8F%8C%E7%BA%BF%E6%80%A7%E6%8F%92%E5%80%BC">双线性插值</a>（Bilinear）、<a target="_blank" rel="noopener" href="https://zh.m.wikipedia.org/zh-hans/%E5%8F%8C%E4%B8%89%E6%AC%A1%E6%8F%92%E5%80%BC">双三次插值</a>（Bicubic），<a target="_blank" rel="noopener" href="https://zh.m.wikipedia.org/zh-hans/Mipmap">MinMap</a>，即学即忘，不展开了。</p><p>单独提一下「<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%90%84%E5%90%91%E5%BC%82%E6%80%A7%E8%BF%87%E6%BB%A4/662077">双向异性过滤</a>（Anisotropic filtering）」。<small>（为啥？因为我Van ♂ 游戏遇到了)。</small>这项能力，能让近远景更加清晰，同时也能辅助理解「摩尔纹」。</p><h3 id="TODO-几何（Geometry）"><a href="#TODO-几何（Geometry）" class="headerlink" title="TODO 几何（Geometry）"></a>TODO 几何（Geometry）</h3><p>讲述的是如何用数据表达自然界的物体。</p><ul><li>凹凸（环境光）：法相贴图、位移贴图、动态曲面区分（directX）</li><li>表示方法：隐式、显式、逻辑运算（交、并、减、距离函数融合）（各种流体）、自分型</li><li>点云，贝塞尔曲线、样条曲线</li><li>网格细分（Loop、Catmull-Clark）、减少、常规化</li><li>Shadow Mapping（硬阴影，软阴影）</li></ul><h3 id="光线追踪（Ray-Tracing）"><a href="#光线追踪（Ray-Tracing）" class="headerlink" title="光线追踪（Ray Tracing）"></a>光线追踪（Ray Tracing）</h3><blockquote><p>光线跟踪，通过跟踪与光学表面发生交互作用的光线从而得到光线经过路径的模型</p></blockquote><p>光线追踪，是介绍算法最多的章节。如果从光子的角度出发，则其运算本质上是立体空间的碰撞检测。</p><blockquote><p>碰撞检测技术中所用的包围盒有两个属性：「简单性」和「紧密性」。</p><p>简单性是指包围盒间进行相交测试时需要的计算量，这不但要求几何形状简单容易计算，而且要求相交测试算法简单快速；</p><p>紧密性要求包围盒尽可能的贴近被包围的对象，这一属性直接关系到需要进行相交测试的包围盒的数目，紧密性越好，参与相交测试的包围盒数目就越少。</p></blockquote><p>最常见的是AABB包围盒（Axis-aligned bounding box）：这是一种近似碰撞检测算法，将物体简化为盒子（x、y、z轴）进行碰撞计算，但对不规则物体，或倾斜的规则图形，会带来较大误差。</p><p>为了加速，碰撞检测常常不是一对一，而是多对多的关系。在此需要引出「空间划分」的概念，属于高中集合概念的拓展：当两类物体的集合不相交，则其一集合的任意物体，均和另一集合的任一物体不相交。</p><p>在空间划分上，可能会涉及以下集中数据结构：</p><ul><li>八叉树（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Octree">Oct-Tree</a>）类比二叉树，差别在于，表示的是三维模型。</li><li>BSP（<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Binary_space_partitioning">Binary space partitioning</a>，二叉空间分割）-Tree：主要原因是：物体常常不是空间均匀分布的。</li><li>KD（k-dimensional k维）-Tree：<em>k</em>-d树是每个节点都为k维点的二叉树。在查找时，可以以类二分查找的方法。但是难以判断包围盒和三角形是否有交集。</li><li>BVH（Bounding Volume Hierarchies 层次包围盒）-Tree：划分的依据不是空间，而是物体。比如：划分「中间」物体 的依据是 「最长轴」。因此，包围盒可能相交。</li></ul><p>光线追踪在数学方面的表示方式：</p><ol><li><p><a target="_blank" rel="noopener" href="https://zh.m.wikipedia.org/zh/%E8%BE%90%E5%B0%84%E5%BA%A6%E9%87%8F%E5%AD%A6">辐射度量学</a><small>（后面带有“学”的文字，都应条件反射肃然起敬）</small>、双向反射分布函数（BRDF-<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/21376124">Bidirectional reflectance distribution function</a>），期望<strong>基于物理学的角度</strong>（而不是各种近似，比如上诉提及的布林-冯模型）去理解和描述光照及其作用。因为涉及较多的计算量，所以一般用于电影而非实时游戏的渲染。</p></li><li><p><a target="_blank" rel="noopener" href="https://zh.m.wikipedia.org/zh-hans/%E6%B3%B0%E5%8B%92%E5%85%AC%E5%BC%8F">泰勒公式</a>（用多项式来近似表示函数在某点周围的情况）展开表示<small>（题外话，<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E8%8A%9D%E8%AF%BA%E6%82%96%E8%AE%BA">芝诺悖论</a>）</small>：可理解为发生了N次折射，n = 0时：直接光照；n=1时：间接光照；n &gt; 1时：全局光照。指的是以数学的角度来描述光照。</p></li><li><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E6%A9%9F%E7%8E%87%E5%AF%86%E5%BA%A6%E5%87%BD%E6%95%B8">概率密度函數</a>（Probability density function，PDF）&amp; 蒙特卡洛积分估算，<a target="_blank" rel="noopener" href="https://its201.com/article/MASILEJFOAISEGJIAE/109512410">Link</a>：大体求的是不同光照在空间意义上的期望值。要义是分布，而不是随机。</p></li></ol><p>微微一提<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E4%BC%BD%E7%8E%9B%E6%A0%A1%E6%AD%A3/7257507">伽玛校正</a>，大意指通过非线性显示方式修正视觉感官。如何理解？因为人眼接受颜色的程度是不同的，如：对红色最不敏感，对蓝色最敏感。参考：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/148205541">【科普向】屏幕（三）之周冬雨排列？钻石排列？那些常见的RGB排列</a>。</p><h3 id="TODO-材质与外观（Material）"><a href="#TODO-材质与外观（Material）" class="headerlink" title="TODO 材质与外观（Material）"></a>TODO 材质与外观（Material）</h3><ul><li><p>反射率、折射、微表面、各向同/异性</p></li><li><p>光线传播路径：</p><ul><li>蒙特卡洛估计：无偏、有偏；双向路径追踪、BTPT</li><li>MLT（马尔科夫链）：通过其中一个样本，在周围生成更多相似路径</li><li>光子映射（有偏）</li><li>VCM（集合双线 + 光子追踪）、IR（实时幅度）：噪声、模糊折中</li></ul></li><li><p>外观建模</p><ul><li><p>非表面建模（头发、沙子），表面建模（玻璃等）</p><ul><li>散射介质（云、雾等）</li><li>噪声函数（用时生成），更真实</li></ul></li></ul></li></ul><h3 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h3><p>最后的章节，做了很多概念的拓展 / 补充，如：</p><p>介绍了<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%B0%8F%E5%AD%94%E6%88%90%E5%83%8F/866213">小孔成像原理</a>（九年义务教育的漏网之鱼，不说了，我先面壁去了），从而演化出相机。进而提及了曝光的影响因子：<small>（我不听我不听，摄影穷三代，单反毁一生）</small></p><ol><li>光圈：越大愿景越模糊</li><li>快门：越慢图像越模糊</li><li>反光度：越大越离散</li></ol><p>一笔带过了「颜色」：什么是<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/47492390">光场</a>，光场的七个维度。</p><p>一笔带过了「动画」，弹簧系统、有限元分析、粒子系统；正向运动学，逆向运动学；梯度下降、动作捕捉。可参考<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV12Q4y1S73g?spm_id_from=333.999.0.0">教程：Games103 基于物理的计算机动画入门</a>。</p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>图形学是多学科交叉融合的一个学科。怪不多以前学校的图形学实验室叫交叉实验室。</p></div></div></div><div class="more section"><div class="pre"><a class="article-link" href="/thought_in_2022.html"><i class="iconfont icon-right"></i> <span>工作的碎碎念</span></a></div><div class="next"><a class="article-link" href="/half_year_in_toutiao.html">2021，挑战和机遇 <i class="iconfont icon-right"></i></a></div></div></main></body><footer class="section fullscreen"><div class="footer-desc">Edeink © 2015-2022 · Powered by Hexo</div></footer><script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.js"></script><script src="/public/js/init.js"></script></html>